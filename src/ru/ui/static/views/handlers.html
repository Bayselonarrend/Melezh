<div x-data="handlersView" x-init="init()">
  <div class="flex space-x-4 items-center mb-6">
    <!-- Иконка шестерёнки -->
    <div class="text-gray-400">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="w-12 h-12">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495" />
      </svg>
    </div>

    <!-- Заголовок и описание -->
    <div class="space-y-1">
      <h2 class="text-2xl font-bold">Панель обработчиков</h2>
      <p>Список всех доступных обработчиков</p>
    </div>

    <!-- Кнопки справа -->
    <div class="flex space-x-2 ml-auto">
      <!-- Кнопка добавления -->
      <button @click="addNewHandler"
        class="p-2 border border-gray-300 rounded-md text-gray-600 hover:bg-gray-100 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg>
      </button>

      <!-- Кнопка обновления -->
      <button @click="loadHandlers()"
        class="p-2 border border-gray-300 rounded-md text-gray-600 hover:bg-gray-100 transition" :disabled="isLoading">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" :class="{'animate-spin': isLoading}" fill="none"
          viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
        </svg>
      </button>
    </div>
  </div>

  <hr class="mb-6">

  <!-- Остальная часть остаётся без изменений -->
  <div x-show="isLoading" class="flex justify-center py-4">
    <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"></div>
  </div>

  <!-- Таблица обработчиков -->
  <div x-show="!isLoading" class="bg-white p-4 rounded-lg shadow overflow-hidden">
    <div x-show="handlers.length > 0">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ключ</th>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Метод</th>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Библиотека</th>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Функция</th>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Статус</th>
            <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Действия</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <template x-for="handler in handlers" :key="handler.key">
            <tr class="hover:bg-gray-50">
              <td class="px-4 py-2 whitespace-nowrap text-sm" x-text="handler.key"></td>
              <td class="px-4 py-2 whitespace-nowrap text-sm" x-text="handler.method"></td>
              <td class="px-4 py-2 whitespace-nowrap text-sm" x-text="handler.library"></td>
              <td class="px-4 py-2 whitespace-nowrap">
                <code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono" x-text="handler.function"></code>
              </td>
              <td class="px-4 py-2 whitespace-nowrap">
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" @change="toggleHandlerStatus(handler)" :checked="handler.active == 1"
                    class="sr-only peer">
                  <div
                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600">
                  </div>
                </label>
              </td>
              <td class="px-4 py-2 whitespace-nowrap text-right text-sm">
                <div class="flex items-center justify-end gap-1">
                  <!-- Кнопка редактирования -->
                  <div class="relative group">
                    <button @click="editHandler(handler)"
                      class="text-gray-400 hover:text-gray-600 transition p-1 rounded hover:bg-gray-100">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                      </svg>
                    </button>
                    <span
                      class="absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block bg-black text-white text-xs py-1 px-2 rounded whitespace-nowrap">
                      Редактировать
                    </span>
                  </div>

                  <!-- Кнопка удаления -->
                  <div class="relative group">
                    <button @click="deleteHandler(handler)" type="button"
                      class="text-red-400 hover:text-red-600 transition p-1 rounded hover:bg-gray-100">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                      </svg>
                    </button>
                    <span
                      class="absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block bg-black text-white text-xs py-1 px-2 rounded whitespace-nowrap">
                      Удалить
                    </span>
                  </div>
                </div>
              </td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>

    <!-- Нет данных -->
    <div x-show="handlers.length === 0 && !isLoading" class="text-center py-8 text-gray-500">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="w-12 h-12 mx-auto mb-2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
      </svg>
      <p class="text-sm"><b>Нет доступных обработчиков.</b> Вы можете создать новый обработчик, нажав значок "+" в правом верхнем углу</p>
    </div>
  </div>
</div>